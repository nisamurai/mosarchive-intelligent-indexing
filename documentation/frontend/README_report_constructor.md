# –ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –æ—Ç—á—ë—Ç–∞ –∏ —ç–∫—Å–ø–æ—Ä—Ç –≤ CSV

## –û–ø–∏—Å–∞–Ω–∏–µ

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –æ—Ç—á—ë—Ç–∞ ‚Äî —ç—Ç–æ –º–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏ —ç–∫—Å–ø–æ—Ä—Ç–∞ –æ—Ç—á—ë—Ç–æ–≤ –ø–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã–º –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –≤ —Ñ–æ—Ä–º–∞—Ç–µ CSV. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤—ã–±–∏—Ä–∞—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø–æ–ª—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –∏ –ø–æ–ª—É—á–∞—Ç—å —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –æ—Ç—á—ë—Ç—ã —Å –¥–∞–Ω–Ω—ã–º–∏ –∏–∑ –∞—Ä—Ö–∏–≤–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- ‚úÖ **–í—ã–±–æ—Ä –ø–æ–ª–µ–π –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞** - –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –≤—ã–±–∏—Ä–∞—Ç—å –∏–∑ 13+ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–ª–µ–π
- ‚úÖ **–ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã** - –±—ã—Å—Ç—Ä–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –æ—Ç—á—ë—Ç–æ–≤ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- ‚úÖ **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä** - —Ç–∞–±–ª–∏—Ü–∞ —Å –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ –∏ –æ–±—Ä–∞–∑—Ü–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö
- ‚úÖ **–ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –∫–æ–¥–∏—Ä–æ–≤–∫–∞** - UTF-8 —Å BOM –¥–ª—è Excel
- ‚úÖ **–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ CSV** - –ø–æ–ª–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å RFC 4180
- ‚úÖ **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö** - –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –∏ –ø–æ–ª–µ–π

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è –æ—Ç—á—ë—Ç–∞

#### –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
- `fileName` - –ò–º—è —Ñ–∞–π–ª–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `processingDate` - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- `fileSize` - –†–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –º–µ–≥–∞–±–∞–π—Ç–∞—Ö
- `status` - –°—Ç–∞—Ç—É—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞

#### –ê—Ä—Ö–∏–≤–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã
- `fund` - –ù–æ–º–µ—Ä –∞—Ä—Ö–∏–≤–Ω–æ–≥–æ —Ñ–æ–Ω–¥–∞
- `opis` - –ù–æ–º–µ—Ä –æ–ø–∏—Å–∏
- `delo` - –ù–æ–º–µ—Ä –¥–µ–ª–∞
- `archiveCode` - –ü–æ–ª–Ω—ã–π –∞—Ä—Ö–∏–≤–Ω—ã–π —à–∏—Ñ—Ä
- `fio` - –§–∞–º–∏–ª–∏—è, –∏–º—è, –æ—Ç—á–µ—Å—Ç–≤–æ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `date` - –î–∞—Ç–∞ —É–∫–∞–∑–∞–Ω–Ω–∞—è –≤ –¥–æ–∫—É–º–µ–Ω—Ç–µ
- `documentNumber` - –ù–æ–º–µ—Ä –∏–ª–∏ –∫–æ–¥ –¥–æ–∫—É–º–µ–Ω—Ç–∞
- `organization` - –ù–∞–∑–≤–∞–Ω–∏–µ –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏
- `address` - –ê–¥—Ä–µ—Å –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞

#### –¢–µ–∫—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
- `recognizedText` - –í–µ—Å—å —Ä–∞—Å–ø–æ–∑–Ω–∞–Ω–Ω—ã–π —Ç–µ–∫—Å—Ç –¥–æ–∫—É–º–µ–Ω—Ç–∞

### –ü—Ä–∏–º–µ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

```typescript
interface DocumentData {
  fileName: string;
  archiveCode?: string;
  recognizedText?: string;
  fund?: number;
  opis?: number;
  delo?: number;
  fio?: string;
  date?: string;
  documentNumber?: string;
  address?: string;
  organization?: string;
  processingDate?: string;
  fileSize?: number;
  status?: string;
}
```

## –ü—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã

### 1. –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è (`basic`)
```javascript
['fileName', 'processingDate', 'fileSize', 'status']
```

### 2. –ê—Ä—Ö–∏–≤–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã (`archiveAttributes`)
```javascript
['fund', 'opis', 'delo', 'fio', 'date', 'documentNumber']
```

### 3. –î–æ–∫—É–º–µ–Ω—Ç–∞–ª—å–Ω—ã–µ –∞—Ç—Ä–∏–±—É—Ç—ã (`docAttributes`)
```javascript
['fio', 'date', 'documentNumber', 'address', 'organization']
```

### 4. –° –ø–æ–ª–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º (`fullText`)
```javascript
['fileName', 'recognizedText', 'processingDate']
```

### 5. –ü–æ–ª–Ω—ã–π –∞—Ä—Ö–∏–≤–Ω—ã–π (`archiveFull`)
```javascript
['archiveCode', 'fund', 'opis', 'delo', 'fio', 'date', 'documentNumber', 'fileName']
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –∫–æ–¥–µ

### 1. –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```typescript
import { exportDocumentsToCSV } from './lib/csvExport';
import { createSampleData } from './lib/documentDataAdapter';

// –°–æ–∑–¥–∞—ë–º —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ
const documents = createSampleData(5);

// –û–ø—Ä–µ–¥–µ–ª—è–µ–º –ø–æ–ª—è –¥–ª—è –æ—Ç—á—ë—Ç–∞
const fields = [
  { key: 'fileName', label: '–ò–º—è —Ñ–∞–π–ª–∞', category: 'basic' },
  { key: 'fund', label: '–§–æ–Ω–¥', category: 'attributes' },
  { key: 'fio', label: '–§–ò–û', category: 'attributes' },
  { key: 'date', label: '–î–∞—Ç–∞', category: 'attributes' }
];

// –í—ã–±–∏—Ä–∞–µ–º –ø–æ–ª—è –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞
const selectedFields = ['fileName', 'fund', 'fio', 'date'];

// –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º –≤ CSV
const result = exportDocumentsToCSV(documents, fields, selectedFields, 'archive_report');
console.log('–≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω:', result);
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤

```typescript
import { FIELD_TEMPLATES } from './lib/csvExport';

// –ò—Å–ø–æ–ª—å–∑—É–µ–º –≥–æ—Ç–æ–≤—ã–π —à–∞–±–ª–æ–Ω
const selectedFields = FIELD_TEMPLATES.archiveAttributes;

const result = exportDocumentsToCSV(documents, fields, selectedFields, 'template_report');
```

### 3. –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ React-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç

```typescript
import ReportConstructor from './components/ReportConstructor';

function App() {
  const documents = getDocumentsData(); // –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö
  
  return (
    <ReportConstructor 
      documents={documents}
      className="my-report-constructor"
    />
  );
}
```

## –§–æ—Ä–º–∞—Ç —ç–∫—Å–ø–æ—Ä—Ç–∞ CSV

### –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—è —Ñ–æ—Ä–º–∞—Ç–∞

- **–ö–æ–¥–∏—Ä–æ–≤–∫–∞**: UTF-8 —Å BOM –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —Ä—É—Å—Å–∫–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
- **–†–∞–∑–¥–µ–ª–∏—Ç–µ–ª—å**: –∑–∞–ø—è—Ç–∞—è (,) —Å–æ–≥–ª–∞—Å–Ω–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç—É RFC 4180
- **–≠–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**: –∫–∞–≤—ã—á–∫–∏ —É–¥–≤–∞–∏–≤–∞—é—Ç—Å—è, –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞–∫–ª—é—á–∞—é—Ç—Å—è –≤ –∫–∞–≤—ã—á–∫–∏ –µ—Å–ª–∏ —Å–æ–¥–µ—Ä–∂–∞—Ç —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã
- **–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: Excel, Google Sheets, LibreOffice Calc

### –ü—Ä–∏–º–µ—Ä CSV

```csv
–ò–º—è —Ñ–∞–π–ª–∞,–ê—Ä—Ö–∏–≤–Ω—ã–π —à–∏—Ñ—Ä,–§–æ–Ω–¥,–û–ø–∏—Å—å,–î–µ–ª–æ,–§–ò–û,–î–∞—Ç–∞
–∑–∞—è–≤–ª–µ–Ω–∏–µ_–æ_—Å–ø—Ä–∞–≤–∫–µ.pdf,"01-0203-0745-000002",1,203,745,"–ò–≤–∞–Ω–æ–≤ –ò.–ò.",15.03.1924
–º–µ—Ç—Ä–∏—á–µ—Å–∫–∞—è_–∑–∞–ø–∏—Å—å.tiff,"02-1545-0321-000045",2,1545,321,"–ü–µ—Ç—Ä–æ–≤–∞ –ê.–°.",22.07.1941
```

### –§—É–Ω–∫—Ü–∏—è —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è

```typescript
const escapeCSVValue = (value: any): string => {
  const stringValue = String(value || '');
  const needsQuoting = stringValue.includes(',') || 
                       stringValue.includes('"') || 
                       stringValue.includes('\n') || 
                       stringValue.includes('\r');
  
  if (!needsQuoting) {
    return stringValue;
  }
  
  const escapedValue = stringValue.replace(/"/g, '""');
  return `"${escapedValue}"`;
};
```

## –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞

1. **–ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ–ª–µ–π –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º** - –ø–æ–ª—è —Å–≥—Ä—É–ø–ø–∏—Ä–æ–≤–∞–Ω—ã –ø–æ —Ç–∏–ø–∞–º: –æ—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è, –∞—Ç—Ä–∏–±—É—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–∞, —Ç–µ–∫—Å—Ç–æ–≤–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
2. **–°–≤–æ—Ä–∞—á–∏–≤–∞–µ–º—ã–µ —Å–µ–∫—Ü–∏–∏** - –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –º–æ–∂—É—Ç –±—ã—Ç—å —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç—ã –∏–ª–∏ —Å–≤—ë—Ä–Ω—É—Ç—ã
3. **–ë—ã—Å—Ç—Ä—ã–µ —à–∞–±–ª–æ–Ω—ã** - –∫–Ω–æ–ø–∫–∏ –¥–ª—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –Ω–∞–±–æ—Ä–æ–≤ –ø–æ–ª–µ–π
4. **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω—ã–π –ø—Ä–æ—Å–º–æ—Ç—Ä** - —Ç–∞–±–ª–∏—Ü–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –ø–µ—Ä–µ–¥ —ç–∫—Å–ø–æ—Ä—Ç–æ–º
5. **–í–∞–ª–∏–¥–∞—Ü–∏—è** - –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤—ã–±–æ—Ä –ø–æ–ª–µ–π –∏ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

```typescript
export const ReportConstructor: React.FC<ReportConstructorProps> = ({
  documents,
  className
}) => {
  const [selectedFields, setSelectedFields] = useState<string[]>(['fileName', 'fund', 'opis', 'delo', 'fio', 'date']);
  const [expandedCategories, setExpandedCategories] = useSelector([]);
  const [previewMode, setPreviewMode] = useState(true);
  const [isExporting, setIsExporting] = useState(false);

  // ... –ª–æ–≥–∏–∫–∞ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞
};
```

## –§–∞–π–ª–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
src/
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ ReportConstructor.tsx      # –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞
‚îú‚îÄ‚îÄ lib/
‚îÇ   ‚îú‚îÄ‚îÄ csvExport.ts              # –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ CSV
‚îÇ   ‚îî‚îÄ‚îÄ documentDataAdapter.ts    # –ê–¥–∞–ø—Ç–µ—Ä—ã –¥–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
‚îú‚îÄ‚îÄ examples/
‚îÇ   ‚îî‚îÄ‚îÄ reportExample.ts          # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
‚îî‚îÄ‚îÄ documentation/
    ‚îî‚îÄ‚îÄ README_report_constructor.md
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–º–µ—Ä 1: –≠–∫—Å–ø–æ—Ä—Ç –∞—Ä—Ö–∏–≤–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

```typescript
const selectedFields = ['fund', 'opis', 'delo', 'fio', 'date'];
const result = exportDocumentsToCSV(documents, fields, selectedFields, 'archive_data');
```

–†–µ–∑—É–ª—å—Ç–∞—Ç:
```csv
–§–æ–Ω–¥,–û–ø–∏—Å—å,–î–µ–ª–æ,–§–ò–û,–î–∞—Ç–∞
203,745,2,"–ò–≤–∞–Ω–æ–≤ –ò.–ò.",15.03.1924
1545,321,45,"–ü–µ—Ç—Ä–æ–≤–∞ –ê.–°.",22.07.1941
```

### –ü—Ä–∏–º–µ—Ä 2: –≠–∫—Å–ø–æ—Ä—Ç —Å –ø–æ–ª–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º

```typescript
const selectedFields = ['fileName', 'recognizedText', 'processingDate', 'fio'];
const result = exportDocumentsToCSV(documents, fields, selectedFields, 'text_export');
```

–†–µ–∑—É–ª—å—Ç–∞—Ç –≤–∫–ª—é—á–∞–µ—Ç –ø–æ–ª–Ω—ã–µ —Ç–µ–∫—Å—Ç—ã –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –∫–æ–ª–æ–Ω–∫–∞—Ö.

### –ü—Ä–∏–º–µ—Ä 3: –ü–∞–∫–µ—Ç–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç

```typescript
// –≠–∫—Å–ø–æ—Ä—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –æ—Ç—á—ë—Ç–æ–≤ –≤ —Ä–∞–∑–Ω—ã—Ö —Ñ–æ—Ä–º–∞—Ç–∞—Ö
const templates = [
  { name: 'brief', fields: FIELD_TEMPLATES.basic },
  { name: 'archive', fields: FIELD_TEMPLATES.archiveAttributes },
  { name: 'full', fields: FIELD_TEMPLATES.archiveFull }
];

templates.forEach(template => {
  exportDocumentsToCSV(documents, fields, template.fields, template.name);
});
```

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π

1. **–û–ø—Ä–µ–¥–µ–ª–∏—Ç–µ –ø–æ–ª–µ –≤ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ**:
```typescript
interface DocumentData {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –ø–æ–ª—è
  newField?: string;
}
```

2. **–î–æ–±–∞–≤—å—Ç–µ –≤ —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –ø–æ–ª–µ–π**:
```typescript
const newField: ReportField = {
  key: 'newField',
  label: '–ù–æ–≤–æ–µ –ø–æ–ª–µ',
  description: '–û–ø–∏—Å–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –ø–æ–ª—è',
  category: 'attributes' // –∏–ª–∏ 'basic' –∏–ª–∏ 'text'
};
```

3. **–û–±–Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –∏–∑–≤–ª–µ—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏–π**:
```typescript
export const getFieldValue = (document: DocumentData, fieldKey: string): string => {
  switch (fieldKey) {
    // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–ª—É—á–∞–∏
    case 'newField':
      return document.newField || '';
    default:
      return String((document as any)[fieldKey] || '');
  }
};
```

### –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤—ã—Ö —à–∞–±–ª–æ–Ω–æ–≤

```typescript
export const FIELD_TEMPLATES = {
  // ... —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —à–∞–±–ª–æ–Ω—ã
  customTemplate: ['field1', 'field2', 'field3']
} as const;
```

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

1. **–ü—Ä–æ–±–ª–µ–º—ã —Å –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –≤ Excel**
   - –†–µ—à–µ–Ω–∏–µ: –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è UTF-8 BOM –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∫–æ–¥–∏—Ä–æ–≤–∫–∏

2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ —ç–∫—Ä–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–∏–º–≤–æ–ª–æ–≤**
   - –†–µ—à–µ–Ω–∏–µ: —Ñ—É–Ω–∫—Ü–∏—è `escapeCSVValue` –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤—Å–µ —Å–ª—É–∂–µ–±–Ω—ã–µ —Å–∏–º–≤–æ–ª—ã

3. **–ë–æ–ª—å—à–æ–π –æ–±—ä—ë–º –¥–∞–Ω–Ω—ã—Ö**
   - –†–µ—à–µ–Ω–∏–µ: —Ñ—É–Ω–∫—Ü–∏—è –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç —Ç—ã—Å—è—á –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å-–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–º

4. **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –¥–∞–Ω–Ω—ã—Ö**
   - –†–µ—à–µ–Ω–∏–µ: –≤–∞–ª–∏–¥–∞—Ü–∏—è –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ç–∏–≤–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –æ–± –æ—à–∏–±–∫–∞—Ö

### –ö–æ–¥ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –æ—à–∏–±–æ–∫

```typescript
try {
  const result = exportDocumentsToCSV(documents, fields, selectedFields, fileName);
  console.log('‚úÖ –≠–∫—Å–ø–æ—Ä—Ç –∑–∞–≤–µ—Ä—à—ë–Ω —É—Å–ø–µ—à–Ω–æ:', result);
} catch (error) {
  console.error('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ:', error.message);
  alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ –æ—Ç—á—ë—Ç–∞. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –ø–æ–¥—Ä–æ–±–Ω–æ—Å—Ç–µ–π.');
}
```

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø—Ä–∏–º–µ—Ä

–û—Ç–∫—Ä–æ–π—Ç–µ —Ñ–∞–π–ª `report_export_demo.html` –≤ –±—Ä–∞—É–∑–µ—Ä–µ –¥–ª—è –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π –∫–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä–∞ –æ—Ç—á—ë—Ç–∞.

### –ü—Ä–∏–º–µ—Ä—ã –≤ –∫–æ–¥–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–º–µ—Ä—ã –∏–∑ `src/examples/reportExample.ts`:

```typescript
import { runAllExamples } from './examples/reportExample';

// –ó–∞–ø—É—Å–∫ –≤—Å–µ—Ö –ø—Ä–∏–º–µ—Ä–æ–≤
runAllExamples();
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –±—Ä–∞—É–∑–µ—Ä–∞

```typescript
import { checkBrowserSupport } from './lib/csvExport';

if (checkBrowserSupport()) {
  console.log('‚úÖ –ë—Ä–∞—É–∑–µ—Ä –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —ç–∫—Å–ø–æ—Ä—Ç CSV');
} else {
  console.log('‚ùå –ë—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞');
}
```

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ö–æ–Ω—Å—Ç—Ä—É–∫—Ç–æ—Ä –æ—Ç—á—ë—Ç–∞ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç –≥–∏–±–∫—É—é –∏ –º–æ—â–Ω—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è —ç–∫—Å–ø–æ—Ä—Ç–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤. –í—ã –º–æ–∂–µ—Ç–µ:

- üéØ **–í—ã–±–∏—Ä–∞—Ç—å –Ω—É–∂–Ω—ã–µ –ø–æ–ª—è** –∏–∑ 13+ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
- üìã **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≥–æ—Ç–æ–≤—ã–µ —à–∞–±–ª–æ–Ω—ã** –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç—á—ë—Ç–æ–≤
- üëÄ **–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å** —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
- üíæ **–≠–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å –≤ CSV** —Å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π –∫–æ–¥–∏—Ä–æ–≤–∫–æ–π –¥–ª—è Excel
- üìä **–ü–æ–ª—É—á–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É** –ø–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ–º—ã–º –¥–∞–Ω–Ω—ã–º
- üîß **–õ–µ–≥–∫–æ —Ä–∞—Å—à–∏—Ä—è—Ç—å** —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å –Ω–æ–≤—ã–º–∏ –ø–æ–ª—è–º–∏ –∏ —à–∞–±–ª–æ–Ω–∞–º–∏

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –∏ –º–æ–∂–µ—Ç –±—ã—Ç—å –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞ –≤ –ª—é–±–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è–º–∏.
