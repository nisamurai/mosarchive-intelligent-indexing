# Архитектура системы

## Обзор

Веб-сервис с применением средств искусственного интеллекта для автоматизированного извлечения данных из образов архивных документов, их индексирования и наполнения базы данных.

В соответствии с требованиями информационной безопасности, система разработана для работы **в закрытом контуре без доступа к интернету**.

## Технологический стек

- **Frontend**: React 18 + TypeScript
- **Backend**: Python + FastAPI
- **Сборщик**: Vite
- **Стили**: Tailwind CSS
- **Иконки**: Lucide React
- **Пакетный менеджер**: Bun

## Архитектура взаимодействия

```
┌─────────────────────────────────────────────────────────────┐
│                        Frontend (React)                     │
│  ┌──────────────┐  ┌──────────────┐  ┌──────────────┐       │
│  │   Компоненты │  │     Хуки     │  │   Контексты  │       │
│  │              │  │              │  │              │       │
│  │ • UploadPage │  │ • usePlaceh. │  │ • AuthContext│       │
│  │ • VerifyPage │  │ • useAuth    │  │ • Processing │       │
│  │ • ReportCons.│  │ • useNav.    │  │              │       │
│  └──────┬───────┘  └──────┬───────┘  └──────────────┘       │
│         │                 │                                 │
│         └────────┬────────┘                                 │
│                  │ HTTP Requests                            │
└──────────────────┼──────────────────────────────────────────┘
                   │
                   ▼
┌─────────────────────────────────────────────────────────────┐
│                    Backend (FastAPI)                        │
│  ┌────────────────────────────────────────────────────────┐ │
│  │                   Main Application                     │ │
│  └────────────────────────────────────────────────────────┘ │
│                             │                               │
│    ┌────────────────────────┼────────────────────────┐      │
│    ▼            ▼           ▼           ▼            ▼      │
│  ┌──────┐  ┌────────┐  ┌────────┐  ┌────────┐  ┌────────┐   │
│  │Upload│  │Preproc.│  │  OCR   │  │Attrib. │  │Placeho.│   │
│  │Module│  │Module  │  │ Module │  │Module  │  │Module  │   │
│  └──────┘  └────────┘  └────────┘  └────────┘  └────┬───┘   │
│                                                     │       │
│                                           ┌─────────▼─────┐ │
│                                           │   Локальные   │ │
│                                           │   заглушки    │ │
│                                           └───────────────┘ │
└─────────────────────────────────────────────────────────────┘
```

## Ключевые модули

### Frontend
- **Компоненты** — UI компоненты для всех страниц
- **Хуки** — `usePlaceholders`, `useAuth`, `useNavigation`, `useProcessing`
- **Контексты** — глобальное состояние приложения

### Backend
- **Placeholders** — модуль заглушек для оффлайн работы
- **Upload** — загрузка файлов
- **Preprocess** — предобработка изображений
- **OCR** — распознавание текста
- **Attributes** — извлечение атрибутов
- **Report** — генерация отчётов
- **Statistics** — статистика обработки

## Структура проекта

```
src/
├── components/
│   ├── UploadComponent.tsx    # Основной компонент загрузки
│   └── VerifyPage.tsx        # Компонент верификации результатов
├── lib/
│   ├── image_processing.py    # Модуль предобработки изображений
│   ├── attribute_recognition.py # Модуль атрибутивного распознавания
│   └── utils.ts              # Утилиты (cn функция для Tailwind)
├── App.tsx                   # Главный компонент приложения
├── main.tsx                  # Точка входа
└── index.css                 # Глобальные стили

documentation/
├── frontend/                        # Документация фронтенда
│   ├── README_image_processing.md      # Документация модуля обработки изображений
│   ├── README_attribute_recognition.md # Документация модуля атрибутивного распознавания
│   ├── README_verification_module.md   # Документация модуля верификации результатов
│   ├── README_statistics_component.md  # Документация компонента статистики
│   └── README_auth.md                  # Документация системы авторизации
└── backend/                         # Документация бэкенда
    └── README.md                        # Полная документация Backend API
```

## Особенности реализации

1. **Валидация файлов**: Проверка формата и размера файлов
2. **Прогресс-бар**: Визуализация процесса загрузки и обработки
3. **Обработка ошибок**: Понятные сообщения об ошибках
4. **Верификация результатов**: Интерактивный интерфейс для проверки и редактирования распознанного текста
5. **Синхронизация состояния**: Автоматическое сохранение изменений между компонентами
6. **Управление ресурсами**: Оптимизация памяти через автоматическую очистку URL объектов
7. **Адаптивный дизайн**: Работает на всех устройствах
8. **Accessibility**: 
   - Поддержка клавиатурной навигации (Tab, Enter, Пробел, Escape)
   - ARIA-атрибуты для скрин-ридеров
   - Семантическая разметка
   - Focus-индикаторы для кнопок
   - Альтернативный текст для изображений

## Модуль заглушек (Placeholders)

Система использует специальный модуль `backend/placeholders.py`, который предоставляет:
- Текстовые заглушки для интерфейса
- Примеры данных для отчётов
- Мок-статистику для тестирования
- Статусы обработки файлов

Подробнее: [Документация модуля заглушек](backend/README_placeholders.md)

## Заглушки для ИИ

В текущей версии все вызовы ИИ заменены заглушками:
- Загрузка файлов симулируется с задержкой
- Обработка документов выводится в консоль
- В будущем здесь будут реальные вызовы API ИИ
